# Mybatis

SqlSession 객체는 사용 후 자원을 반드시 해제해줘야 한다.

~~~java
try {
  ...
} finally {
  sqlSession.close();
}
~~~

# Mybatis-Spring

Mybatis-Spring를 통해 만들어진 SqlSessionTemplate 객체는 SqlSession과 달리 내부적으로 close()를 호출하여 자원 해제를 해준다.

단, 또다른 문제가 생기는데 바로 코드상으로 트랜잭션을 관리할 수 없다는 것이다.

즉, rollback(), commit() 등의 작업을 할 수 없다.

> 가장 간단한 해결 방법은 트랜잭션 관리가 필요한 클래스 또는 메서드에 @Transactional 어노테이션을 붙여주는 것이다.

또 다른 해결 방법은 아래와 같이 transactionManager를 빈으로부터 할당 받는 방법이 있다.

~~~java
@Autowired
private DataSourceTransactionManager transactionManager;

TransactionStatus transactionStatus = transactionManager.getTransaction(new DefaultTransactionDefinition());

try{
  ...
  transactionManager.commit(transactionStatus);
} catch {
  transactionManager.rollback(transactionStatus);
}
~~~

또다른 해결 방법은 아래 사이트를 참조해라. (구방식)

![Mybatis-Spring 트랜잭션 관리 방법](https://barunmo.blogspot.com/2013/06/mybatis.html)


# @Transactional

1. Class 선언
   => 클래스 내 각 Method에 모두 적용된다.

2. Method 선언

> Method 선언이 Class 선언보다 우선한다.

